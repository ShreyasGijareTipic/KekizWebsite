import{j as e,w as B,r as j}from"./index-CoZNXrT3.js";import{a as _,h as M}from"./api-8_quPuaU.js";import{u as v}from"./DefaultLayout-BFij5oOH.js";import{C,a as y,b as L,c as S,d as w}from"./CModalTitle-yUagMCk3.js";import{a as g}from"./index.esm-DG3saitl.js";import{C as N}from"./CForm-CWuSMnRv.js";import{C as x}from"./CFormLabel-DOuP-TYD.js";import{C as p}from"./CFormInput-D071rTfS.js";function D({visible:d,setVisible:s}){var a;const l=_(),{t:m}=v("global"),r="img/"+((a=l==null?void 0:l.company_info)==null?void 0:a.paymentQRCode),u=async()=>{try{const h=await(await fetch(r)).blob(),i=new File([h],"QRCode.png",{type:"image/png"});navigator.canShare&&navigator.canShare({files:[i]})?await navigator.share({title:"Check out my QR code!",files:[i]}):alert("Your browser does not support sharing files.")}catch(c){console.error("Error sharing the image:",c)}};return e.jsx(e.Fragment,{children:e.jsxs(C,{backdrop:"static",visible:d,onClose:()=>s(!1),"aria-labelledby":"StaticBackdropExampleLabel",children:[e.jsx(y,{children:e.jsx(L,{id:"StaticBackdropExampleLabel",children:m("LABELS.qr")})}),e.jsx(S,{children:e.jsx("div",{className:"text-center",children:e.jsx("img",{style:{maxHeight:"350px"},className:"img-thumbnail img-fluid",src:r})})}),e.jsxs(w,{children:[e.jsx(g,{color:"success",onClick:u,children:m("LABELS.share")}),e.jsx(g,{color:"danger",onClick:()=>s(!1),children:m("LABELS.close")})]})]})})}function H({visible:d,hint:s,setVisible:l,onSuccess:m}){const r=_(),{showToast:u}=B(),{t:a}=v("global"),[c,h]=j.useState({name:"",mobile:"",birthdate:"",anniversary_date:"",discount:0,company_id:(r==null?void 0:r.company_id)||"",show:!0});j.useEffect(()=>{if(d){const t=/^\d+$/;h(o=>({...o,name:t.test(s==null?void 0:s.trim())?"":s==null?void 0:s.trim(),mobile:t.test(s==null?void 0:s.trim())?s==null?void 0:s.trim():""}))}},[s,d]);const i=t=>{const{name:o,value:f}=t.target;h(n=>({...n,[o]:f}))},b=()=>{h({name:"",mobile:"",birthdate:"",anniversary_date:"",discount:0,company_id:(r==null?void 0:r.company_id)||"",show:!0})},E=async t=>{t.preventDefault();const o=t.target;if(!o.checkValidity()){o.classList.add("was-validated");return}const f={...c};try{const n=await M("/api/customer",f);n!=null&&n.id?(u("success",a("MSG.data_saved_successfully_msg")),m(n),l(!1),b()):u("danger",a("MSG.failed_to_create"))}catch(n){u("danger",`Error occurred: ${n.message||n}`)}};return e.jsxs(C,{backdrop:"static",visible:d,onClose:()=>{b(),l(!1)},children:[e.jsx(y,{children:e.jsx(L,{children:a("LABELS.new_customer")})}),e.jsx(S,{children:e.jsxs(N,{className:"needs-validation",noValidate:!0,onSubmit:E,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{children:a("LABELS.customer_name")}),e.jsx(p,{type:"text",name:"name",placeholder:a("MSG.enter_customer_name_msg"),value:c.name,onChange:i,required:!0}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.name_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{children:a("LABELS.mobile_number")}),e.jsx(p,{type:"tel",name:"mobile",placeholder:a("MSG.enter_mob_no_msg"),value:c.mobile,onChange:t=>{const o=t.target.value.replace(/\D/g,"");o.length<=10&&i({target:{name:"mobile",value:o}})},maxLength:10,pattern:"\\d{10}",required:!0}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.mobile_number_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{children:a("LABELS.birthdate")}),e.jsx(p,{type:"date",name:"birthdate",value:c.birthdate,onChange:i,required:!0}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.birthdate_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{children:a("LABELS.anniversary_date")}),e.jsx(p,{type:"date",name:"anniversary_date",value:c.anniversary_date,onChange:i})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{color:"success",type:"submit",children:a("LABELS.submit")}),"Â ",e.jsx(g,{color:"danger",type:"button",onClick:()=>{b(),l(!1)},children:a("LABELS.close")})]})]})})]})}export{H as N,D as Q};
