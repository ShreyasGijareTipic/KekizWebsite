import{w as N,r,m as R,j as s}from"./index-Bg23EJBh.js";import{f as S,b as o,h as k}from"./api-8_quPuaU.js";import{c as t,a as q}from"./index.esm-8VmjjbFz.js";import{C as F}from"./CRow-Cu5LofkQ.js";import{C as T}from"./CCol-YFH1-bI8.js";import{C as U,a as V}from"./CCardBody-Jm5-jwwI.js";import{C as B}from"./CCardHeader-VfQPesaz.js";import{C as D}from"./CForm-DKH37w0G.js";import{C as n,a as d}from"./CInputGroupText-c01pXpIo.js";import{C as c,c as G}from"./CFormInput-DUEAMG4e.js";import"./CFormLabel-Cqbh7rjs.js";const X=()=>{const{showToast:i}=N(),[h,C]=r.useState(""),l=r.useRef(),[p,x]=r.useState(""),[f,j]=r.useState(""),[u,w]=r.useState(!1),[g,P]=r.useState(!1),y=R();r.useEffect(()=>{E()},[]);const E=async()=>{try{const e=await S("/api/user");C(e.email)}catch(e){i("danger","Error occured "+e)}},v=e=>{x(e.target.value),m(e.target.value,f)},b=e=>{j(e.target.value),m(p,e.target.value)},m=(e,a)=>{w(e!==a)},I=async e=>{if(e.preventDefault(),P(!0),e.currentTarget.checkValidity()===!1||u){e.stopPropagation();return}try{const a={email:h,password:l.current.value,new_password:p};(await k("/api/changePassword",a)).status==1&&y("/login")}catch(a){i("danger","Error occured "+a),console.error("Error updating password:",a)}};return s.jsx(F,{children:s.jsx(T,{xs:12,children:s.jsxs(U,{className:"mb-3",children:[s.jsx(B,{children:s.jsx("strong",{children:"Change Password"})}),s.jsx(V,{children:s.jsxs(D,{noValidate:!0,validated:g,onSubmit:I,children:[s.jsx("p",{className:"text-body-secondary",children:"Your current password is required to change to a new password"}),s.jsxs(n,{className:"mb-4",children:[s.jsx(d,{children:s.jsx(t,{icon:o})}),s.jsx(c,{ref:l,id:"oldPassword",type:"password",placeholder:"Enter Current Password",autoComplete:"current-password",feedbackInvalid:"Please provide your current password.",required:!0})]}),s.jsxs(n,{className:"mb-4",children:[s.jsx(d,{children:s.jsx(t,{icon:o})}),s.jsx(c,{onChange:v,id:"newPassword",type:"password",placeholder:"Enter new password",autoComplete:"new-password",required:!0})]}),s.jsxs(n,{className:"mb-4",children:[s.jsx(d,{children:s.jsx(t,{icon:o})}),s.jsx(c,{onChange:b,id:"reEnterPassword",type:"password",invalid:u,placeholder:"Re-enter new password",autoComplete:"re-enter-new-password",required:!0}),s.jsx(G,{invalid:!0,children:"Please re-enter the new password."})]}),s.jsx(q,{type:"submit",color:"primary",children:"Update Password"})]})})]})})})};export{X as default};
