import{y as x,w as z,r as u,j as e}from"./index-Bg23EJBh.js";import{f as y,p as b}from"./api-8_quPuaU.js";import{C as P}from"./CRow-Cu5LofkQ.js";import{C as S}from"./CCol-YFH1-bI8.js";import{C as N,a as q}from"./CCardBody-Jm5-jwwI.js";import{C as k}from"./CCardHeader-VfQPesaz.js";import{C as w}from"./CForm-DKH37w0G.js";import{C as n}from"./CFormLabel-Cqbh7rjs.js";import{C as m}from"./CFormInput-DUEAMG4e.js";import{C as E}from"./CFormSelect-CaG7Qby9.js";import{a as h}from"./index.esm-8VmjjbFz.js";const H=()=>{const p=x(),{showToast:o}=z(),[t,l]=u.useState({id:0,name:"",sizes:[{size:"",qty:0,oPrice:0,bPrice:0}]}),j=[{label:"500 gm",value:"500 gm"},{label:"1 kg",value:"1 kg"},{label:"2 kg",value:"2 kg"},{label:"5 kg",value:"5 kg"}],C=a=>{const{name:s,value:r}=a.target;l({...t,[s]:r})},d=(a,s)=>{const{name:r,value:c}=s.target,i=[...t.sizes];i[a]={...i[a],[r]:c},l({...t,sizes:i})},g=a=>{if(t.sizes.length>1){const s=t.sizes.filter((r,c)=>c!==a);l({...t,sizes:s})}},v=async()=>{try{const a=await y("/api/product/"+p.id);l({id:a.id,name:a.name,sizes:a.sizes.map(s=>({size:s.size,qty:s.qty,oPrice:s.oPrice,bPrice:s.bPrice}))})}catch(a){o("danger","Error occurred "+a)}};u.useEffect(()=>{v()},[]);const f=async a=>{a.preventDefault();const s=a.target;if(!s.checkValidity()){s.classList.add("was-validated");return}const r=t.sizes.length>1,c={name:t.name,multiSize:r,sizes:t.sizes};try{const i=await b("/api/product/"+t.id,c);i!=null&&i.id?o("success","Product updated successfully"):o("danger","Error occurred, please try again later.")}catch(i){o("danger","Error occurred: "+i.message)}};return e.jsx(P,{children:e.jsx(S,{xs:12,children:e.jsxs(N,{className:"mb-4",children:[e.jsx(k,{children:e.jsx("strong",{children:"Edit Product"})}),e.jsx(q,{children:e.jsxs(w,{className:"needs-validation",noValidate:!0,onSubmit:f,children:[e.jsx("div",{className:"row mb-2",children:e.jsxs("div",{className:"col-6",children:[e.jsx(n,{htmlFor:"pname",children:"Product Name"}),e.jsx(m,{type:"text",id:"pname",placeholder:"Product Name",name:"name",value:t.name,onChange:C,required:!0}),e.jsx("div",{className:"invalid-feedback",children:"Product name is required"})]})}),t.sizes.map((a,s)=>e.jsxs("div",{className:"row mb-2",children:[e.jsxs("div",{className:"col-4",children:[e.jsx(n,{htmlFor:`size_${s}`,children:"Size"}),e.jsxs(E,{id:`size_${s}`,name:"size",value:a.size,onChange:r=>d(s,r),required:!0,children:[e.jsx("option",{value:"",children:"Select Size"}),j.map((r,c)=>e.jsx("option",{value:r.value,children:r.label},c))]})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(n,{htmlFor:`qty_${s}`,children:"Quantity"}),e.jsx(m,{type:"number",id:`qty_${s}`,placeholder:"0",min:"1",name:"qty",value:a.qty,onChange:r=>d(s,r),required:!0})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(n,{htmlFor:`oPrice_${s}`,children:"Selling Price"}),e.jsx(m,{type:"number",id:`oPrice_${s}`,placeholder:"0",min:"1",name:"oPrice",value:a.oPrice,onChange:r=>d(s,r),required:!0})]}),e.jsx("div",{className:"col-12 mt-2",children:t.sizes.length>1&&e.jsx(h,{color:"danger",onClick:()=>g(s),children:"-"})})]},s)),e.jsx("div",{className:"mb-3",children:e.jsx(h,{color:"success",type:"submit",children:"Submit"})})]})})]})})})};export{H as default};
