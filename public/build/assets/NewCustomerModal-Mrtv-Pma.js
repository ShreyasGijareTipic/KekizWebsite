import{j as e,w as B,r as j}from"./index-Bg23EJBh.js";import{a as _,h as M}from"./api-8_quPuaU.js";import{u as C}from"./DefaultLayout-ClwM_41s.js";import{C as y,a as v,b as L,c as S,d as w}from"./CModalTitle-CtLHuCtH.js";import{a as b}from"./index.esm-8VmjjbFz.js";import{C as N}from"./CForm-DKH37w0G.js";import{C as h}from"./CFormLabel-Cqbh7rjs.js";import{C as p}from"./CFormInput-DUEAMG4e.js";function D({visible:d,setVisible:s}){var a;const n=_(),{t:m}=C("global"),r="img/"+((a=n==null?void 0:n.company_info)==null?void 0:a.paymentQRCode),u=async()=>{try{const x=await(await fetch(r)).blob(),c=new File([x],"QRCode.png",{type:"image/png"});navigator.canShare&&navigator.canShare({files:[c]})?await navigator.share({title:"Check out my QR code!",files:[c]}):alert("Your browser does not support sharing files.")}catch(o){console.error("Error sharing the image:",o)}};return e.jsx(e.Fragment,{children:e.jsxs(y,{backdrop:"static",visible:d,onClose:()=>s(!1),"aria-labelledby":"StaticBackdropExampleLabel",children:[e.jsx(v,{children:e.jsx(L,{id:"StaticBackdropExampleLabel",children:m("LABELS.qr")})}),e.jsx(S,{children:e.jsx("div",{className:"text-center",children:e.jsx("img",{style:{maxHeight:"350px"},className:"img-thumbnail img-fluid",src:r})})}),e.jsxs(w,{children:[e.jsx(b,{color:"success",onClick:u,children:m("LABELS.share")}),e.jsx(b,{color:"danger",onClick:()=>s(!1),children:m("LABELS.close")})]})]})})}function H({visible:d,hint:s,setVisible:n,onSuccess:m}){const r=_(),{showToast:u}=B(),{t:a}=C("global"),[o,x]=j.useState({name:"",mobile:"",birthdate:"",anniversary_date:"",discount:0,company_id:(r==null?void 0:r.company_id)||"",show:!0});j.useEffect(()=>{if(d){const l=/^\d+$/;x(i=>({...i,name:l.test(s==null?void 0:s.trim())?"":s==null?void 0:s.trim(),mobile:l.test(s==null?void 0:s.trim())?s==null?void 0:s.trim():""}))}},[s,d]);const c=l=>{const{name:i,value:f}=l.target;x(t=>({...t,[i]:f}))},g=()=>{x({name:"",mobile:"",birthdate:"",anniversary_date:"",discount:0,company_id:(r==null?void 0:r.company_id)||"",show:!0})},E=async l=>{l.preventDefault();const i=l.target;if(!i.checkValidity()){i.classList.add("was-validated");return}const f={...o};try{const t=await M("/api/customer",f);t!=null&&t.id?(u("success",a("MSG.data_saved_successfully_msg")),m(t),n(!1),g()):u("danger",a("MSG.failed_to_create"))}catch(t){u("danger",`Error occurred: ${t.message||t}`)}};return e.jsxs(y,{backdrop:"static",visible:d,onClose:()=>{g(),n(!1)},children:[e.jsx(v,{children:e.jsx(L,{children:a("LABELS.new_customer")})}),e.jsx(S,{children:e.jsxs(N,{className:"needs-validation",noValidate:!0,onSubmit:E,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:a("LABELS.customer_name")}),e.jsx(p,{type:"text",name:"name",placeholder:a("MSG.enter_customer_name_msg"),value:o.name,onChange:c,required:!0}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.name_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:a("LABELS.mobile_number")}),e.jsx(p,{type:"text",name:"mobile",placeholder:a("MSG.enter_mob_no_msg"),value:o.mobile,onChange:c,minLength:10,maxLength:10,pattern:"\\d{10}",required:!0}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.mobile_number_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:a("LABELS.birthdate")}),e.jsx(p,{type:"date",name:"birthdate",value:o.birthdate,onChange:c,required:!0}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.birthdate_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:a("LABELS.anniversary_date")}),e.jsx(p,{type:"date",name:"anniversary_date",value:o.anniversary_date,onChange:c})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{color:"success",type:"submit",children:a("LABELS.submit")}),"Â ",e.jsx(b,{color:"danger",type:"button",onClick:()=>{g(),n(!1)},children:a("LABELS.close")})]})]})})]})}export{H as N,D as Q};
