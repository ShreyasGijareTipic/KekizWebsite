import{r as a,j as t,w as I}from"./index-Bg23EJBh.js";import{M as v}from"./mantine-react-table.esm-Q6Itqhmp.js";import{f as $,m as w,j as D}from"./api-8_quPuaU.js";import{C as N}from"./ConfirmationModal-CQe-o_rD.js";import{C as F,a as A,c as K,d as V}from"./CModalTitle-CtLHuCtH.js";import{C as y}from"./CFormLabel-Cqbh7rjs.js";import{C}from"./CFormInput-DUEAMG4e.js";import{a as j}from"./index.esm-8VmjjbFz.js";import{C as k}from"./CRow-Cu5LofkQ.js";import{C as z}from"./DefaultLayout-ClwM_41s.js";import"./Table-AyJUSGqJ.js";import"./cil-mobile-BTelR--Q.js";const T=({visible:p,setVisible:d,size:o,onSave:m})=>{const[s,u]=a.useState(o);a.useEffect(()=>{u(o)},[o]);const i=g=>{const{name:n,value:r}=g.target;u(c=>({...c,[n]:r}))},l=()=>{m&&m(s)};return t.jsxs(F,{visible:p,onClose:()=>d(!1),children:[t.jsx(A,{children:"Edit Size"}),t.jsxs(K,{children:[t.jsx(y,{htmlFor:"size",children:"Size"}),t.jsx(C,{id:"size",name:"size",value:(s==null?void 0:s.size)||"",onChange:i,placeholder:"Enter size"}),t.jsx(y,{htmlFor:"quantity",className:"mt-3",children:"Quantity"}),t.jsx(C,{id:"quantity",name:"quantity",value:(s==null?void 0:s.quantity)||"",onChange:i,type:"number",placeholder:"Enter quantity"}),t.jsx(y,{htmlFor:"sellingPrice",className:"mt-3",children:"Selling Price"}),t.jsx(C,{id:"sellingPrice",name:"sellingPrice",value:(s==null?void 0:s.sellingPrice)||"",onChange:i,type:"number",placeholder:"Enter selling price"})]}),t.jsxs(V,{children:[t.jsx(j,{color:"primary",onClick:l,children:"Save"}),t.jsx(j,{color:"secondary",onClick:()=>d(!1),children:"Cancel"})]})]})},_=()=>{const[p,d]=a.useState([]),[o,m]=a.useState(null),[s,u]=a.useState(null),[i,l]=a.useState(!1),[g,n]=a.useState(!1),{showToast:r}=I(),c=async()=>{try{const e=await $("/api/product");d(e)}catch(e){r("danger",`Error fetching products: ${e.message}`)}};a.useEffect(()=>{c()},[]);const P=e=>{u({sizeId:e.sizeId,sizeName:e.size,productName:e.name}),l(!0)},E=async()=>{try{s&&s.sizeId&&(await w(`/api/product/size/${s.sizeId}`),l(!1),c(),r("success",`Size "${s.sizeName}" deleted successfully.`))}catch(e){r("danger",`Error deleting size: ${e.message}`)}},b=e=>{m(e),n(!0)},M=async e=>{try{await D(`/api/product/size/${e.sizeId}`,{size:e.size,qty:e.quantity,oPrice:e.sellingPrice}),n(!1),c(),r("success",`Size "${e.size}" updated successfully.`)}catch(h){r("danger",`Error updating size: ${h.message}`)}},S=[{accessorKey:"name",header:"Product Name"},{accessorKey:"size",header:"Size"},{accessorKey:"sellingPrice",header:"Selling Price"},{accessorKey:"quantity",header:"Quantity"},{accessorKey:"actions",header:"Actions",Cell:({cell:e})=>t.jsxs("div",{children:[t.jsx(z,{role:"button",color:"info",onClick:()=>b(e.row.original),children:"Edit"}),"Â ",t.jsx(z,{role:"button",color:"danger",onClick:()=>P(e.row.original),children:"Delete"})]})}],q=(e=>e.flatMap(h=>{var x;return((x=h.sizes)==null?void 0:x.map(f=>({...h,size:f.size,sellingPrice:f.oPrice,quantity:f.qty,sizeId:f.id})))||[]}))(p);return t.jsxs(k,{children:[t.jsx(N,{visible:i,setVisible:l,onYes:E,resource:`Delete size "${s==null?void 0:s.sizeName}" from product "${s==null?void 0:s.productName}"?`}),t.jsx(T,{visible:g,setVisible:n,size:o,onSave:M}),t.jsx(v,{columns:S,data:q,enableFullScreenToggle:!1})]})};export{_ as default};
