import{y as W,r as d,w as B,j as e}from"./index-Bg23EJBh.js";import"./html2pdf-CA4gDf6a.js";import{a as O,f as q}from"./api-8_quPuaU.js";import{C as Q,a as R}from"./CCardBody-Jm5-jwwI.js";import{C as F}from"./CCardHeader-VfQPesaz.js";import{b as U,a as $}from"./index.esm-8VmjjbFz.js";const X=()=>{var i,o,x;const a=(i=O())==null?void 0:i.company_info,A=W();d.useState(0),d.useState(""),d.useState(0);const{showToast:S}=B(),[s,w]=d.useState({customer:{},date:"",products:[],discount:"",amountPaid:0,paymentMode:"",InvoiceStatus:"",finalAmount:0,InvoiceNumber:"",discount:0,balance_amount:0,status:"",DeliveryDate:"",InvoiceType:""}),T=()=>{window.print()},k=async()=>{var c,n,h,m,u,j,p,N,v,f,b,y,_,g,I;try{const t=await q("/api/order/"+A.id),z=(((c=t.order)==null?void 0:c.order_items)||[]).map(r=>{var C,D,P;return{product_name:((C=r.product)==null?void 0:C.name)||"N/A",product_size:((D=r.product_size)==null?void 0:D.size)||"N/A",dPrice:r.price||0,product_unit:((P=r.product)==null?void 0:P.unit)||"",dQty:r.qty||0,total_price:r.price*r.qty||0}}),E=(((n=t.order)==null?void 0:n.custom_products)||[]).map(r=>({product_name:r.name,product_size:r.size||"N/A",dPrice:r.price,product_unit:"",dQty:r.qty,total_price:r.price*r.qty})),M=[...z,...E];w({customer:((h=t.order)==null?void 0:h.customer)||{},date:((m=t.order)==null?void 0:m.invoiceDate)||"",products:M,discount:((u=t.order)==null?void 0:u.discount)||"",amountPaid:((j=t.order)==null?void 0:j.paid_amount)||0,paymentMode:((p=t.order)==null?void 0:p.order_type)===0?"Cash":"Online (UPI/Bank Transfer)",InvoiceStatus:((N=t.order)==null?void 0:N.order_status)===1?"Delivered Order":((v=t.order)==null?void 0:v.order_status)===2?"Order Pending":"Canceled Order",finalAmount:Math.round((f=t.order)==null?void 0:f.total_amount)||0,balance_amount:((b=t.order)==null?void 0:b.balance_amount)||0,InvoiceNumber:((y=t.order)==null?void 0:y.id)||"",status:((_=t.order)==null?void 0:_.order_status)||"",DeliveryDate:((g=t.order)==null?void 0:g.delivery_date)||"",InvoiceType:((I=t.order)==null?void 0:I.order_type)||""})}catch(t){S("danger","Error occurred: "+t),console.error("Error fetching order data:",t)}};d.useEffect(()=>{k()},[]);let l;return s.status===0?l=e.jsx("h5",{className:"text-danger ",children:s.InvoiceStatus}):s.status===1?l=e.jsx("h5",{className:"text-success ",children:s.InvoiceStatus}):s.status===2&&(l=e.jsx("h5",{className:"text-warning ",children:s.InvoiceStatus})),e.jsxs(Q,{className:"mb-4",children:[e.jsx(F,{className:"no-print",children:e.jsx("strong",{children:"Invoice"})}),e.jsx(R,{children:e.jsxs(U,{className:"container-md invoice-content",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4"}),e.jsx("div",{className:"col-4 text-center",children:l}),e.jsx("div",{className:"col-4"})]}),e.jsxs("div",{className:"d-flex flex-row mb-3",children:[e.jsx("div",{className:"flex-fill",children:e.jsx("img",{src:"img/"+a.logo,width:"100",height:"100",alt:"Logo"})}),e.jsx("div",{className:"flex-fill"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{children:a.company_name}),e.jsx("p",{children:a.land_mark}),e.jsxs("p",{children:[a.Tal,", ",a.Dist,", ",a.pincode]}),e.jsxs("p",{children:["Phone: ",a.phone_no]})]})]}),e.jsxs("div",{className:"row mt-10",children:[e.jsx("div",{className:"flex-fill col-6",children:e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{style:{fontWeight:"bold"},children:"Invoice To:"}),e.jsxs("p",{style:{fontWeight:"bold"},children:["Customer Name: ",e.jsx("span",{children:(o=s.customer)==null?void 0:o.name})]}),e.jsxs("p",{style:{fontWeight:"bold"},children:["Mobile Number: ",e.jsx("span",{children:(x=s.customer)==null?void 0:x.mobile})]})]})}),e.jsx("div",{className:"col-2"}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"flex-fill col-md-8",children:[e.jsxs("h6",{style:{fontWeight:"bold"},children:["Invoice No: ",s.InvoiceNumber]}),e.jsxs("p",{style:{fontWeight:"bold"},children:["Invoice Date: ",e.jsx("span",{children:s.date})]}),s.InvoiceType===2&&e.jsxs("p",{style:{fontWeight:"bold"},children:["Delivery Date: ",e.jsx("span",{children:s.DeliveryDate})]})]})})]}),e.jsx("div",{className:"row section",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-bordered border-black",children:[e.jsx("thead",{className:"table-success border-black",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",children:"Sr No"}),e.jsx("th",{className:"text-center",children:"Item Name"}),e.jsx("th",{className:"text-center",children:"Size"}),e.jsx("th",{className:"text-center",children:"Price (Rs)"}),e.jsx("th",{className:"text-center",children:"Quantity"}),e.jsx("th",{className:"text-center",children:"Total (Rs)"})]})}),e.jsx("tbody",{children:Array.isArray(s.products)&&s.products.length>0?s.products.map((c,n)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center",children:n+1}),e.jsx("td",{className:"text-center",children:c.product_name||"N/A"}),e.jsx("td",{className:"text-center",children:c.product_size||"N/A"}),e.jsxs("td",{className:"text-center",children:[c.dPrice," ₹",c.product_unit?` per ${c.product_unit}`:""]}),e.jsxs("td",{className:"text-center",children:[c.dQty,c.product_unit?` ${c.product_unit}`:""]}),e.jsxs("td",{className:"text-center",children:[c.total_price||0," ₹"]})]},n)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center text-muted",children:"No products available"})})})]})})}),e.jsx("div",{className:"row section",children:e.jsx("div",{className:"col-md-12",children:e.jsx("table",{className:"table table-bordered border-black",children:e.jsxs("tbody",{children:[s.discount>0&&e.jsxs("tr",{children:[e.jsx("td",{children:"Discount (%):"}),e.jsxs("td",{children:[s.discount," %"]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Total amount to be paid:"}),e.jsxs("td",{children:[s.finalAmount," ₹"]})]}),e.jsx("tr",{}),e.jsxs("tr",{children:[e.jsx("td",{children:"Amount Paid:"}),e.jsxs("td",{children:[s.amountPaid," ₹"]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Balance Amount:"}),e.jsxs("td",{children:[s.balance_amount," ₹"]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Payment Mode:"}),e.jsx("td",{children:s.paymentMode})]})]})})})}),e.jsxs("div",{className:"d-flex border p-3 border-black",children:[e.jsx("div",{className:"flex-fill",children:e.jsxs("div",{className:"d-flex flex-column mb-3",children:[e.jsx("h6",{children:"Bank Details"}),e.jsx("p",{children:a.bank_name}),e.jsxs("p",{children:["Account No: ",a.account_no]}),e.jsxs("p",{children:["IFSC code: ",a.IFSC_code]})]})}),e.jsx("div",{className:"flex-fill",children:e.jsxs("div",{className:"d-flex flex-column align-items-center text-center ",children:[e.jsx("h6",{children:"E-SIGNATURE"}),e.jsx("img",{height:"100",width:"100",src:"img/"+a.sign,alt:"signature"}),e.jsx("p",{children:"Authorized Signature"})]})})]}),e.jsx("div",{className:"row section mt-3",children:e.jsx("div",{className:"col-md-12 text-center",children:e.jsx("p",{children:"This bill has been computer-generated and is authorized."})})}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx($,{color:"primary",variant:"outline",onClick:T,className:"d-print-none me-2",children:"Print"})})]})})]})};export{X as default};
