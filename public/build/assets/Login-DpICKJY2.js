import{r as a,_ as R,a as S,b as T,c as E,P as g,m as H,w as U,j as e}from"./index-Bg23EJBh.js";import{b as V,c as p,a as j}from"./index.esm-8VmjjbFz.js";import{i as G,c as z,b as D,e as F,s as _}from"./api-8_quPuaU.js";import{C}from"./CRow-Cu5LofkQ.js";import{C as c}from"./CCol-YFH1-bI8.js";import{C as q,a as A}from"./CCardBody-Jm5-jwwI.js";import{C as B}from"./CForm-DKH37w0G.js";import{C as y,a as v}from"./CInputGroupText-c01pXpIo.js";import{C as b}from"./CFormInput-DUEAMG4e.js";import"./CFormLabel-Cqbh7rjs.js";var m=a.forwardRef(function(o,i){var l=o.children,n=o.className,t=R(o,["children","className"]);return S.createElement("div",T({className:E("card-group",n)},t,{ref:i}),l)});m.propTypes={children:g.node,className:g.string};m.displayName="CCardGroup";var Z=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M336,113.375H176v144H56V296L255.8,496,456,296.007V257.375H336Zm81.361,176L255.826,450.746,94.616,289.375H208v-144h96v144Z' class='ci-primary'/><rect width='400' height='32' x='56' y='17.376' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"];const K=""+new URL("kakeiz-LeYiyIAK.png",import.meta.url).href,M=""+new URL("cakeshop-1Qvegpwj.jpg",import.meta.url).href,ae=()=>{const[o,i]=a.useState(!1),[l,n]=a.useState(!1),t=H(),u=a.useRef(),h=a.useRef(),{showToast:d}=U();a.useEffect(()=>{G()&&t("/dashboard")},[]),window.addEventListener("beforeinstallprompt",r=>{r.preventDefault(),window.deferredPrompt=r,n(!0)});const N=async()=>{if(window.deferredPrompt){window.deferredPrompt.prompt();const{outcome:r}=await window.deferredPrompt.userChoice;r==="accepted"&&(window.deferredPrompt=null,n(!1))}},k=async r=>{var f,x;const P=r.currentTarget;if(r.preventDefault(),r.stopPropagation(),P.checkValidity()!==!0){i(!0);return}i(!0);const I=(f=u.current)==null?void 0:f.value,L=(x=h.current)==null?void 0:x.value;try{const s=await F({email:I,password:L});if(s.blocked)d("danger",s.message);else{const w=s==null?void 0:s.user;w?(_(s),w.type>1?t("/invoice"):t("/dashboard")):d("danger","Please provide valid email and password")}}catch{d("danger","Please provide valid email and password")}};return e.jsxs("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",style:{backgroundImage:`url(${M})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[e.jsx(V,{children:e.jsx(C,{className:"justify-content-center",children:e.jsx(c,{md:6,children:e.jsx(m,{children:e.jsx(q,{className:"p-4",children:e.jsx(A,{children:e.jsxs(B,{noValidate:!0,validated:o,onSubmit:k,children:[e.jsx("img",{src:K,style:{width:"100%",height:"auto",maxHeight:"200px"},className:"object-fit-contain"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(y,{className:"mb-3",children:[e.jsx(v,{children:e.jsx(p,{icon:z})}),e.jsx(b,{ref:u,id:"username",placeholder:"Username",autoComplete:"username",feedbackInvalid:"Please provide username.",required:!0})]}),e.jsxs(y,{className:"mb-4",children:[e.jsx(v,{children:e.jsx(p,{icon:D})}),e.jsx(b,{ref:h,id:"password",type:"password",placeholder:"Password",autoComplete:"current-password",feedbackInvalid:"Please provide password.",required:!0})]}),e.jsxs(C,{children:[e.jsx(c,{xs:6,children:e.jsx(j,{color:"primary",type:"submit",className:"px-4",children:"Login"})}),e.jsx(c,{xs:6,children:e.jsx(c,{xs:6,className:"text-right"})})]})]})})})})})})}),l&&e.jsx(j,{onClick:N,color:"success",style:{position:"fixed",top:"20px",right:"20px",borderRadius:"50%",width:"56px",height:"56px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)"},children:e.jsx(p,{icon:Z,style:{fontSize:"24px",color:"white"}})})]})};export{ae as default};
