import{r as x,m as g,w as N,j as e}from"./index-OeoBNat3.js";import{f as w,h as L}from"./api-8_quPuaU.js";import{u as E}from"./DefaultLayout-B6SAEV22.js";import{C as q}from"./CRow-B0v1wP3B.js";import{C as A}from"./CCol-BhG1DmFz.js";import{C as B,a as F}from"./CCardBody-HZcxyyc1.js";import{C as I}from"./CCardHeader-D3QUcPyo.js";import{C as T}from"./CForm-nOHKzzo5.js";import{C as c}from"./CFormLabel-DxfY1rNV.js";import{a as u}from"./index.esm-BSQayu9G.js";import{C as k}from"./CFormSelect-B3syApAW.js";import{C as d}from"./CFormInput-BMIMxTq1.js";import"./cil-mobile-BLiG_LYI.js";const Q=()=>{const[y,h]=x.useState(!1),[j,v]=x.useState([]);g();const{showToast:p}=N(),{t}=E("global"),[a,l]=x.useState({name:"",desc:"",expense_id:void 0,typeNotSet:!0,qty:0,price:0,total_price:0,expense_date:"",show:!0}),f=async()=>{try{const r=await w("/api/expenseType"),s=["Select Expense Type"];s.push(...r.filter(n=>n.show===1).map(n=>({label:n.name,value:n.id,disabled:n.show!==1}))),v(s)}catch(r){p("danger","Error occured "+r)}};x.useEffect(()=>{f()},[]);const C=r=>{r.total_price=(parseFloat(r.price)||0)*(parseInt(r.qty)||0)},o=r=>{const{name:s,value:n}=r.target;s==="price"||s==="qty"?l(m=>{const i={...m};return i[s]=n,C(i),{...i}}):s==="expense_id"?l(m=>{const i={...m};return i[s]=n,i.typeNotSet=n===void 0,{...i}}):s==="name"?/^[A-Za-z\s]*$/.test(n)&&l({...a,[s]:n}):l({...a,[s]:n})},b=async r=>{if(r.preventDefault(),r.stopPropagation(),h(!0),a.expense_id&&a.price>0&&a.qty>0&&a.name)try{await L("/api/expense",{...a})?p("success",t("MSG.new_expense_added_successfully_msg")):p("danger",t("MSG.error_occured_please_try_again_later_msg")),_()}catch(s){p("danger","Error occured "+s)}else l(s=>({...s,typeNotSet:s.expense_id===void 0}))},S=new Date().toISOString().split("T")[0],_=async()=>{l({name:"",desc:"",expense_id:a.expense_id,qty:0,price:0,total_price:0,expense_date:"",show:!0,typeNotSet:a.expense_id===void 0}),h(!1)};return e.jsx(q,{children:e.jsx(A,{xs:12,children:e.jsxs(B,{className:"mb-4",children:[e.jsx(I,{children:e.jsx("strong",{children:t("LABELS.new_expense")})}),e.jsx(F,{children:e.jsxs(T,{noValidate:!0,validated:y,onSubmit:b,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-4",children:[e.jsxs("div",{className:"mb-3 d-flex align-items-center",children:[e.jsx(c,{htmlFor:"expense_id",children:t("LABELS.expense_type")}),e.jsx(u,{color:"danger",className:"ms-3",onClick:()=>window.location.href="/#/expense/new-type",children:t("LABELS.new_expense_type")})]}),e.jsx(k,{"aria-label":t("MSG.select_expense_type_msg"),value:a.expense_id,id:"expense_id",name:"expense_id",options:j,onChange:o,required:!0,feedbackInvalid:"Select Expense type."})]}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(c,{htmlFor:"name",children:t("LABELS.about_expense")}),e.jsx(d,{type:"text",id:"name",placeholder:"",name:"name",value:a.name,onChange:o,required:!0,feedbackInvalid:"Please provide some note. Only alphabets and spaces are allowed."})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(c,{htmlFor:"expense_date",children:t("LABELS.expense_date")}),e.jsx(d,{type:"date",id:"expense_date",name:"expense_date",max:S,value:a.expense_date,onChange:o,required:!0,feedbackInvalid:"Please select date."})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(c,{htmlFor:"price",children:t("LABELS.price_per_unit")}),e.jsx(d,{type:"number",min:"0",id:"price",placeholder:"",name:"price",value:a.price,onChange:o,required:!0,feedbackInvalid:"Please provide price per unit. Negative numbers not allowed."})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(c,{htmlFor:"qty",children:t("LABELS.total_units")}),e.jsx(d,{type:"number",id:"qty",placeholder:"",name:"qty",min:"0",value:a.qty,onChange:o,required:!0,feedbackInvalid:"Please provide total units. Negative numbers not allowed."})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(c,{htmlFor:"total_price",children:t("LABELS.total_price")}),e.jsx(d,{type:"number",min:"0",id:"total_price",placeholder:"",name:"total_price",value:a.total_price,onChange:o,readOnly:!0})]})})]}),e.jsxs("div",{className:"mb-3 mt-3",children:[e.jsx(u,{color:"success",type:"submit",children:t("LABELS.submit")}),"Â ",e.jsx(u,{color:"secondary",onClick:_,children:t("LABELS.clear")})]})]})})]})})})};export{Q as default};
