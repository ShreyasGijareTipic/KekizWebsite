import{w as y,m as f,r as l,j as e}from"./index-CoZNXrT3.js";import{a as g,f as N,h as _}from"./api-8_quPuaU.js";import{C as w}from"./CRow-C1kAJa4E.js";import{C as k}from"./CCol-6gv0qfQb.js";import{C as S,a as E}from"./CCardBody-KiBmAR96.js";import{C as q}from"./CCardHeader-CzKoGM0V.js";import{C as F}from"./CForm-CWuSMnRv.js";import{C as d}from"./CFormLabel-DOuP-TYD.js";import{C as m}from"./CFormInput-D071rTfS.js";import{C as L}from"./CFormSelect-CVgASmge.js";import{C as B}from"./CFormTextarea-okqZN3IC.js";import{C as D}from"./CFormCheck-QIJdA4HO.js";import{a as p}from"./index.esm-DG3saitl.js";const O=()=>{const{showToast:h}=y(),C=f(),n=g(),[i,c]=l.useState({name:"",mobile:"",birthdate:"",anniversary_date:"",discount:0,company_id:(n==null?void 0:n.company_id)||0,show:!0,address:""}),[x,u]=l.useState([]);l.useEffect(()=>{(async()=>{try{const s=await N("/api/company");if(s!=null&&s.length){const a=s.map(r=>({label:r.company_name,value:r.company_id}));n.type===0?(u(a),a.length>0&&c(r=>({...r,company_id:a[0].value}))):(u(a.filter(r=>r.value===n.company_id)),c(r=>({...r,company_id:n.company_id})))}}catch(s){h("danger","Error occurred: "+s)}})()},[n.type,n.company_id]);const o=l.useCallback(t=>{const{name:s,value:a}=t.target;c(r=>({...r,[s]:a}))},[]),v=l.useCallback(t=>{const{name:s,checked:a}=t.target;c(r=>({...r,[s]:a}))},[]),j=async t=>{t.preventDefault();const s=t.target;if(!s.checkValidity()){s.classList.add("was-validated");return}try{const a=await _("/api/customer",i);a!=null&&a.id?(h("success","Customer created successfully!"),C("/usermanagement/all-users")):h("danger","Failed to create customer.")}catch(a){h("danger","Error occurred: "+a)}},b=()=>{c({name:"",mobile:"",birthdate:"",anniversary_date:"",discount:0,company_id:(n==null?void 0:n.company_id)||0,show:!0,address:""})};return e.jsx(w,{children:e.jsx(k,{xs:12,children:e.jsxs(S,{className:"mb-4",children:[e.jsx(q,{children:e.jsx("strong",{children:"Create New Customer"})}),e.jsx(E,{children:e.jsxs(F,{className:"needs-validation",noValidate:!0,onSubmit:j,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Customer Name"}),e.jsx(m,{type:"text",name:"name",placeholder:"Enter Customer Name",value:i.name,onChange:o,required:!0}),e.jsx("div",{className:"invalid-feedback",children:"Name is required"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Mobile Number"}),e.jsx(m,{type:"text",name:"mobile",placeholder:"Enter Mobile Number",value:i.mobile,onChange:o,pattern:"\\d{10}",minLength:10,maxLength:10,required:!0}),e.jsx("div",{className:"invalid-feedback",children:"Valid mobile number is required"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Birthdate"}),e.jsx(m,{type:"date",name:"birthdate",value:i.birthdate,onChange:o,required:!0}),e.jsx("div",{className:"invalid-feedback",children:"Birthdate is required"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Anniversary Date"}),e.jsx(m,{type:"date",name:"anniversary_date",value:i.anniversary_date,onChange:o})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Company"}),e.jsx(L,{name:"company_id",value:i.company_id,onChange:o,required:!0,children:x.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("div",{className:"invalid-feedback",children:"Please select a company"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Address"}),e.jsx(B,{rows:2,name:"address",value:i.address,onChange:o})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Special Discount (%)"}),e.jsx(m,{type:"number",name:"discount",placeholder:"Enter discount",value:i.discount,onChange:o})]}),e.jsx("div",{className:"mb-3",children:e.jsx(D,{label:"Show for invoicing",name:"show",checked:i.show,onChange:v})}),e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{color:"success",type:"submit",children:"Submit"}),"Â ",e.jsx(p,{color:"secondary",onClick:b,children:"Clear"})]})]})})]})})})};export{O as default};
